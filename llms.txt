# igfetchr

[![CRAN
status](https://www.r-pkg.org/badges/version/igfetchr)](https://cran.r-project.org/package=igfetchr)
[![CRAN RStudio mirror
downloads](https://cranlogs.r-pkg.org/badges/grand-total/igfetchr)](https://cran.r-project.org/package=igfetchr)
[![R-CMD-check](https://github.com/sawsimeon/igfetchr/workflows/R-CMD-check/badge.svg)](https://github.com/sawsimeon/igfetchr/actions)

**igfetchr** is a lightweight R wrapper for the \[IG Trading REST API\]
(<https://labs.ig.com/>). It provides beginner-friendly functions to
fetch market data, search historical prices, execute trades, and get
account details from the \[IG Trading REST API\]
(<https://labs.ig.com/>).

Important: Trading CFDs and spread bets carries a high risk of losing
money. This package is not financial advice.

## Installation

### From CRAN (recommended):

``` r
install.packages("igfetchr")
```

### Install the package from GitHub (development):

``` r
# install.packages("remotes")
remotes::install_github("sawsimeon/igfetchr")
```

## Quick example (mocked / offline)

The package supports an offline “testing” mode so examples and tests run
without internet or API credentials. Set the environment variable
`IGFETCHR_TESTING = "true"` to enable mock behavior.

``` r
Sys.setenv(IGFETCHR_TESTING = "true")

# Mock authentication
auth <- ig_auth(
  username = "demo_user",
  password = "demo_pass",
  api_key = "demo_api_key",
  acc_type = "DEMO",
  acc_number = "ABC123"
)

# Use mock_response to simulate endpoints
markets <- ig_search_markets(
  search_term = "USD/CHF",
  auth = auth,
  mock_response = data.frame(
    epic = "CS.D.USDCHF.CFD.IP",
    instrumentName = "USD/CHF",
    stringsAsFactors = FALSE
  )
)

print(markets)

# Clear testing mode
Sys.unsetenv("IGFETCHR_TESTING")
```

## Vignette

See the vignette `vignettes/getting-started.Rmd` for a short guided demo
that uses mock responses so it runs offline during CRAN checks.

## Real API Usage

For live API calls, set environment variables for security and use
[`ig_auth()`](https://sawsimeon.github.io/igfetchr/reference/ig_auth.md)
without testing mode.

``` r
Sys.setenv(IG_SERVICE_USERNAME = "your_username")
Sys.setenv(IG_SERVICE_PASSWORD = "your_password")
Sys.setenv(IG_SERVICE_API_KEY = "your_api_key")
Sys.setenv(IG_SERVICE_ACC_TYPE = "DEMO")
Sys.setenv(IG_SERVICE_ACC_NUMBER = "ABC123")

auth <- ig_auth()
hist <- ig_get_historical(
  epic = "CS.D.USDCHF.CFD.IP",
  from = "2020-01-01",
  to = "2020-12-31",
  resolution = "D",
  auth = auth
)
print(hist)
```

## Contributing

Please open issues or pull requests on the GitHub repository:
<https://github.com/sawsimeon/igfetchr>

## License

GPL-3 License: <https://cran.r-project.org/web/licenses/GPL-3>

# Package index

## Authentication

Functions for IG API authentication

- [`ig_auth()`](https://sawsimeon.github.io/igfetchr/reference/ig_auth.md)
  : Authenticate with the IG API
- [`ig_close_session()`](https://sawsimeon.github.io/igfetchr/reference/ig_close_session.md)
  [`ig_logout()`](https://sawsimeon.github.io/igfetchr/reference/ig_close_session.md)
  : Close session

## Market Data

Functions for markets, prices, and historical data

- [`ig_get_price()`](https://sawsimeon.github.io/igfetchr/reference/ig_get_price.md)
  : Get current price for a market
- [`ig_get_historical()`](https://sawsimeon.github.io/igfetchr/reference/ig_get_historical.md)
  : Get historical prices for a market
- [`ig_search_markets()`](https://sawsimeon.github.io/igfetchr/reference/ig_search_markets.md)
  : Search markets
- [`ig_get_markets_by_epic()`](https://sawsimeon.github.io/igfetchr/reference/ig_get_markets_by_epic.md)
  : Get market details for one or more epics

## Trading & Accounts

Functions for trades and account info

- [`ig_execute_trade()`](https://sawsimeon.github.io/igfetchr/reference/ig_execute_trade.md)
  : Execute a trade (place OTC position)
- [`ig_get_accounts()`](https://sawsimeon.github.io/igfetchr/reference/ig_get_accounts.md)
  : Retrieve IG account details
- [`ig_get_options()`](https://sawsimeon.github.io/igfetchr/reference/ig_get_options.md)
  : Get options/derivatives positions

## Package

General package information

- [`igfetchr`](https://sawsimeon.github.io/igfetchr/reference/igfetchr.md)
  : igfetchr: Lightweight IG Trading REST API wrapper

## Internal Helpers

Low-level helper functions for API requests

- [`.ig_request()`](https://sawsimeon.github.io/igfetchr/reference/dot-ig_request.md)
  : Internal function to make HTTP requests to IG API

# Articles

### Getting Started

- [Getting Started with
  igfetchr](https://sawsimeon.github.io/igfetchr/articles/getting-started.md):
